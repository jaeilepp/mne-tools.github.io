<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Miscellaneous C functionality &mdash; MNE 0.12.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootswatch-3.3.4/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.12.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="MNE 0.12.0 documentation" href="../../index.html" />
    <link rel="up" title="User Manual" href="../index.html" />
    <link rel="next" title="Release notes" href="c_release_notes.html" />
    <link rel="prev" title="Setup at the Martinos Center" href="martinos.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><img src="../../_static/mne_logo_small.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.12.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../getting_started.html">Get started</a></li>
                <li><a href="../../tutorials.html">Tutorials</a></li>
                <li><a href="../../auto_examples/index.html">Gallery</a></li>
                <li><a href="../../python_reference.html">API</a></li>
                <li><a href="../index.html">Manual</a></li>
                <li><a href="../../faq.html">FAQ</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Examples Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contribute to MNE</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../python_reference.html">Python API Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whats_new.html">What&#8217;s new</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">How to cite MNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">Related publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cited.html">Publications from MNE users</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Miscellaneous C functionality</a><ul>
<li><a class="reference internal" href="#setting-up-anatomical-mr-images-for-mrilab">Setting up anatomical MR images for MRIlab</a></li>
<li><a class="reference internal" href="#cleaning-the-digital-trigger-channel">Cleaning the digital trigger channel</a></li>
<li><a class="reference internal" href="#fixing-channel-information">Fixing channel information</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Miscellaneous C functionality</a><ul>
<li><a class="reference internal" href="#setting-up-anatomical-mr-images-for-mrilab">Setting up anatomical MR images for MRIlab</a></li>
<li><a class="reference internal" href="#cleaning-the-digital-trigger-channel">Cleaning the digital trigger channel</a></li>
<li><a class="reference internal" href="#fixing-channel-information">Fixing channel information</a></li>
</ul>
</li>
</ul>

  <li>
    <a href="martinos.html" title="Previous Chapter: Setup at the Martinos Center"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Setup at the ...</span>
    </a>
  </li>
  <li>
    <a href="c_release_notes.html" title="Next Chapter: Release notes"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Release notes &raquo;</span>
    </a>
  </li>
<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12">
      
  <div class="section" id="miscellaneous-c-functionality">
<h1>Miscellaneous C functionality<a class="headerlink" href="#miscellaneous-c-functionality" title="Permalink to this headline">¶</a></h1>
<div class="section" id="setting-up-anatomical-mr-images-for-mrilab">
<span id="babccehf"></span><h2>Setting up anatomical MR images for MRIlab<a class="headerlink" href="#setting-up-anatomical-mr-images-for-mrilab" title="Permalink to this headline">¶</a></h2>
<p>If you have the Neuromag software installed, the Neuromag
MRI viewer, MRIlab, can be used to access the MRI slice data created
by FreeSurfer . In addition, the
Neuromag MRI directories can be used for storing the MEG/MRI coordinate
transformations created with mne_analyze ,
see <a class="reference internal" href="../gui/analyze.html#cacehgcd"><em>Coordinate frame alignment</em></a>.  During the computation of the forward
solution, mne_do_forwand_solution searches
for the MEG/MRI coordinate in the Neuromag MRI directories, see <a class="reference internal" href="../cookbook.html#babchejd"><em>Computing the forward solution</em></a>. The fif files created by mne_setup_mri can
be loaded into Matlab with the fiff_read_mri function,
see <a class="reference internal" href="../matlab.html#ch-matlab"><em>Matlab toolbox</em></a>.</p>
<p>These functions require running the script mne_setup_mri which
requires that the subject is set with the <tt class="docutils literal"><span class="pre">--subject</span></tt> option
or by the SUBJECT environment variable. The script processes one
or more MRI data sets from <tt class="docutils literal"><span class="pre">$SUBJECTS_DIR/$SUBJECT/mri</span></tt> ,
by default they are T1 and brain. This default can be changed by
specifying the sets by one or more <tt class="docutils literal"><span class="pre">--mri</span></tt> options.</p>
<p>The script creates the directories <tt class="docutils literal"><span class="pre">mri/</span></tt> &lt;<em>name</em>&gt; <tt class="docutils literal"><span class="pre">-neuromag/slices</span></tt> and <tt class="docutils literal"><span class="pre">mri/</span></tt> &lt;<em>name</em>&gt; <tt class="docutils literal"><span class="pre">-neuromag/sets</span></tt> .
If the input data set is in COR format, mne_setup_mri makes
symbolic links from the COR files in the directory <tt class="docutils literal"><span class="pre">mri/</span></tt> &lt;<em>name</em>&gt; into <tt class="docutils literal"><span class="pre">mri/</span></tt> &lt;<em>name</em>&gt; <tt class="docutils literal"><span class="pre">-neuromag/slices</span></tt> ,
and creates a corresponding fif file COR.fif in <tt class="docutils literal"><span class="pre">mri/</span></tt> &lt;<em>name</em>&gt; <tt class="docutils literal"><span class="pre">-neuromag/sets</span></tt> ..
This &#8220;description file&#8221; contains references to
the actual MRI slices.</p>
<p>If the input MRI data are stored in the newer mgz format,
the file created in the <tt class="docutils literal"><span class="pre">mri/</span></tt> &lt;<em>name</em>&gt; <tt class="docutils literal"><span class="pre">-neuromag/sets</span></tt> directory
will include the MRI pixel data as well. If available, the coordinate
transformations to allow conversion between the MRI (surface RAS)
coordinates and MNI and FreeSurfer Talairach coordinates are copied
to the MRI description file. mne_setup_mri invokes mne_make_cor_set ,
described in <a class="reference internal" href="../c_reference.html#mne-make-cor-set"><em>mne_make_cor_set</em></a> to convert the data.</p>
<p>For example:</p>
<p><tt class="docutils literal"><span class="pre">mne_setup_mri</span> <span class="pre">--subject</span> <span class="pre">duck_donald</span> <span class="pre">--mri</span> <span class="pre">T1</span></tt></p>
<p>This command processes the MRI data set T1 for subject duck_donald.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the SUBJECT environment variable is set it    is usually sufficient to run mne_setup_mri without    any options.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the name specified with the <tt class="docutils literal"><span class="pre">--mri</span></tt> option    contains a slash, the MRI data are accessed from the directory specified    and the <tt class="docutils literal"><span class="pre">SUBJECT</span></tt> and <tt class="docutils literal"><span class="pre">SUBJECTS_DIR</span></tt> environment    variables as well as the <tt class="docutils literal"><span class="pre">--subject</span></tt> option are ignored.</p>
</div>
<p>MRIlab can also be used for coordinate frame alignment.
Section 3.3.1 of the MRIlab User&#8217;s Guide,
Neuromag P/N NM20419A-A contains a detailed description of
this task. Employ the images in the set <tt class="docutils literal"><span class="pre">mri/T1-neuromag/sets/COR.fif</span></tt> for
the alignment. Check the alignment carefully using the digitization
data included in the measurement file as described in Section 5.3.1
of the above manual. Save the aligned description file in the same
directory as the original description file without the alignment
information but under a different name.</p>
</div>
<div class="section" id="cleaning-the-digital-trigger-channel">
<span id="babcdbdi"></span><h2>Cleaning the digital trigger channel<a class="headerlink" href="#cleaning-the-digital-trigger-channel" title="Permalink to this headline">¶</a></h2>
<p>The calibration factor of the digital trigger channel used
to be set to a value much smaller than one by the Neuromag data
acquisition software. Especially to facilitate viewing of raw data
in graph it is advisable to change the calibration factor to one.
Furthermore, the eighth bit of the trigger word is coded incorrectly
in the original raw files. Both problems can be corrected by saying:</p>
<p><tt class="docutils literal"><span class="pre">mne_fix_stim14</span></tt> &lt;<em>raw file</em>&gt;</p>
<p>More information about mne_fix_stim14 is
available in <a class="reference internal" href="../c_reference.html#mne-fix-stim14"><em>mne_fix_stim14</em></a>. It is recommended that this
fix is included as the first raw data processing step. Note, however,
the mne_browse_raw and mne_process_raw always sets
the calibration factor to one internally.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If your data file was acquired on or after November 10, 2005 on the Martinos center Vectorview system, it is not necessary to use mne_fix_stim14 .</p>
</div>
</div>
<div class="section" id="fixing-channel-information">
<span id="babcdfjh"></span><h2>Fixing channel information<a class="headerlink" href="#fixing-channel-information" title="Permalink to this headline">¶</a></h2>
<p>There are two potential discrepancies in the channel information
which need to be fixed before proceeding:</p>
<ul class="simple">
<li>EEG electrode locations may be incorrect
if more than 60 EEG channels are acquired.</li>
<li>The magnetometer coil identifiers are not always correct.</li>
</ul>
<p>These potential problems can be fixed with the utilities mne_check_eeg_locations and mne_fix_mag_coil_types,
see <a class="reference internal" href="../c_reference.html#mne-check-eeg-locations"><em>mne_check_eeg_locations</em></a> and <a class="reference internal" href="../c_reference.html#mne-fix-mag-coil-types"><em>mne_fix_mag_coil_types</em></a>.</p>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2012-2016, MNE Developers. Last updated on 2016-05-11.<br/>
    </p>
  </div>
</footer>
  </body>
</html>