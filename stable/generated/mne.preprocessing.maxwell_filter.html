<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>mne.preprocessing.maxwell_filter &mdash; MNE 0.12.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.4/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.12.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="MNE 0.12.0 documentation" href="../index.html" />
    <link rel="up" title="Python API Reference" href="../python_reference.html" />
    <link rel="next" title="mne.preprocessing.read_ica" href="mne.preprocessing.read_ica.html" />
    <link rel="prev" title="mne.preprocessing.ica_find_eog_events" href="mne.preprocessing.ica_find_eog_events.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/mne_logo_small.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.12.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../getting_started.html">Get started</a></li>
                <li><a href="../tutorials.html">Tutorials</a></li>
                <li><a href="../auto_examples/index.html">Gallery</a></li>
                <li><a href="../python_reference.html">API</a></li>
                <li><a href="../manual/index.html">Manual</a></li>
                <li><a href="../faq.html">FAQ</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contribute to MNE</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../python_reference.html">Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new.html">What&#8217;s new</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">How to cite MNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">Related publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cited.html">Publications from MNE users</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">mne.preprocessing.maxwell_filter</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">mne.preprocessing.maxwell_filter</a></li>
</ul>

  <li>
    <a href="mne.preprocessing.ica_find_eog_events.html" title="Previous Chapter: mne.preprocessing.ica_find_eog_events"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; mne.preproces...</span>
    </a>
  </li>
  <li>
    <a href="mne.preprocessing.read_ica.html" title="Next Chapter: mne.preprocessing.read_ica"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">mne.preproces... &raquo;</span>
    </a>
  </li>
<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12">
      
  <div class="section" id="mne-preprocessing-maxwell-filter">
<h1>mne.preprocessing.maxwell_filter<a class="headerlink" href="#mne-preprocessing-maxwell-filter" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="mne.preprocessing.maxwell_filter">
<tt class="descclassname">mne.preprocessing.</tt><tt class="descname">maxwell_filter</tt><big>(</big><em>raw</em>, <em>origin='auto'</em>, <em>int_order=8</em>, <em>ext_order=3</em>, <em>calibration=None</em>, <em>cross_talk=None</em>, <em>st_duration=None</em>, <em>st_correlation=0.98</em>, <em>coord_frame='head'</em>, <em>destination=None</em>, <em>regularize='in'</em>, <em>ignore_ref=False</em>, <em>bad_condition='error'</em>, <em>head_pos=None</em>, <em>st_fixed=True</em>, <em>st_only=False</em>, <em>verbose=None</em><big>)</big><a class="headerlink" href="#mne.preprocessing.maxwell_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply Maxwell filter to data using multipole moments</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Automatic bad channel detection is not currently implemented.
It is critical to mark bad channels before running Maxwell
filtering, so data should be inspected and marked accordingly
prior to running this algorithm.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Not all features of Elekta MaxFilter™ are currently
implemented (see Notes). Maxwell filtering in mne-python
is not designed for clinical use.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>raw</strong> : instance of mne.io.Raw</p>
<blockquote>
<div><p>Data to be filtered</p>
</div></blockquote>
<p><strong>origin</strong> : array-like, shape (3,) | str</p>
<blockquote>
<div><p>Origin of internal and external multipolar moment space in meters.
The default is <tt class="docutils literal"><span class="pre">'auto'</span></tt>, which means a head-digitization-based
origin fit when <tt class="docutils literal"><span class="pre">coord_frame='head'</span></tt>, and <tt class="docutils literal"><span class="pre">(0.,</span> <span class="pre">0.,</span> <span class="pre">0.)</span></tt> when
<tt class="docutils literal"><span class="pre">coord_frame='meg'</span></tt>.</p>
</div></blockquote>
<p><strong>int_order</strong> : int</p>
<blockquote>
<div><p>Order of internal component of spherical expansion.</p>
</div></blockquote>
<p><strong>ext_order</strong> : int</p>
<blockquote>
<div><p>Order of external component of spherical expansion.</p>
</div></blockquote>
<p><strong>calibration</strong> : str | None</p>
<blockquote>
<div><p>Path to the <tt class="docutils literal"><span class="pre">'.dat'</span></tt> file with fine calibration coefficients.
File can have 1D or 3D gradiometer imbalance correction.
This file is machine/site-specific.</p>
</div></blockquote>
<p><strong>cross_talk</strong> : str | None</p>
<blockquote>
<div><p>Path to the FIF file with cross-talk correction information.</p>
</div></blockquote>
<p><strong>st_duration</strong> : float | None</p>
<blockquote>
<div><p>If not None, apply spatiotemporal SSS with specified buffer duration
(in seconds). Elekta&#8217;s default is 10.0 seconds in MaxFilter™ v2.2.
Spatiotemporal SSS acts as implicitly as a high-pass filter where the
cut-off frequency is 1/st_dur Hz. For this (and other) reasons, longer
buffers are generally better as long as your system can handle the
higher memory usage. To ensure that each window is processed
identically, choose a buffer length that divides evenly into your data.
Any data at the trailing edge that doesn&#8217;t fit evenly into a whole
buffer window will be lumped into the previous buffer.</p>
</div></blockquote>
<p><strong>st_correlation</strong> : float</p>
<blockquote>
<div><p>Correlation limit between inner and outer subspaces used to reject
ovwrlapping intersecting inner/outer signals during spatiotemporal SSS.</p>
</div></blockquote>
<p><strong>coord_frame</strong> : str</p>
<blockquote>
<div><p>The coordinate frame that the <tt class="docutils literal"><span class="pre">origin</span></tt> is specified in, either
<tt class="docutils literal"><span class="pre">'meg'</span></tt> or <tt class="docutils literal"><span class="pre">'head'</span></tt>. For empty-room recordings that do not have
a head&lt;-&gt;meg transform <tt class="docutils literal"><span class="pre">info['dev_head_t']</span></tt>, the MEG coordinate
frame should be used.</p>
</div></blockquote>
<p><strong>destination</strong> : str | array-like, shape (3,) | None</p>
<blockquote>
<div><p>The destination location for the head. Can be <tt class="docutils literal"><span class="pre">None</span></tt>, which
will not change the head position, or a string path to a FIF file
containing a MEG device&lt;-&gt;head transformation, or a 3-element array
giving the coordinates to translate to (with no rotations).
For example, <tt class="docutils literal"><span class="pre">destination=(0,</span> <span class="pre">0,</span> <span class="pre">0.04)</span></tt> would translate the bases
as <tt class="docutils literal"><span class="pre">--trans</span> <span class="pre">default</span></tt> would in MaxFilter™ (i.e., to the default
head location).</p>
</div></blockquote>
<p><strong>regularize</strong> : str | None</p>
<blockquote>
<div><p>Basis regularization type, must be &#8220;in&#8221; or None.
&#8220;in&#8221; is the same algorithm as the &#8220;-regularize in&#8221; option in
MaxFilter™.</p>
</div></blockquote>
<p><strong>ignore_ref</strong> : bool</p>
<blockquote>
<div><p>If True, do not include reference channels in compensation. This
option should be True for KIT files, since Maxwell filtering
with reference channels is not currently supported.</p>
</div></blockquote>
<p><strong>bad_condition</strong> : str</p>
<blockquote>
<div><p>How to deal with ill-conditioned SSS matrices. Can be &#8220;error&#8221;
(default), &#8220;warning&#8221;, or &#8220;ignore&#8221;.</p>
</div></blockquote>
<p><strong>head_pos</strong> : array | None</p>
<blockquote>
<div><p>If array, movement compensation will be performed.
The array should be of shape (N, 10), holding the position
parameters as returned by e.g. <cite>read_head_pos</cite>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.12.</span></p>
</div>
</div></blockquote>
<p><strong>st_fixed</strong> : bool</p>
<blockquote>
<div><p>If True (default), do tSSS using the median head position during the
<tt class="docutils literal"><span class="pre">st_duration</span></tt> window. This is the default behavior of MaxFilter
and has been most extensively tested.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.12.</span></p>
</div>
</div></blockquote>
<p><strong>st_only</strong> : bool</p>
<blockquote>
<div><p>If True, only tSSS (temporal) projection of MEG data will be
performed on the output data. The non-tSSS parameters (e.g.,
<tt class="docutils literal"><span class="pre">int_order</span></tt>, <tt class="docutils literal"><span class="pre">calibration</span></tt>, <tt class="docutils literal"><span class="pre">head_pos</span></tt>, etc.) will still be
used to form the SSS bases used to calculate temporal projectors,
but the ouptut MEG data will <em>only</em> have temporal projections
performed. Noise reduction from SSS basis multiplication,
cross-talk cancellation, movement compensation, and so forth
will not be applied to the data. This is useful, for example, when
evoked movement compensation will be performed with
<a class="reference internal" href="mne.epochs.average_movements.html#mne.epochs.average_movements" title="mne.epochs.average_movements"><tt class="xref py py-func docutils literal"><span class="pre">mne.epochs.average_movements()</span></tt></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.12.</span></p>
</div>
</div></blockquote>
<p><strong>verbose</strong> : bool, str, int, or None</p>
<blockquote>
<div><p>If not None, override default verbose level (see mne.verbose)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>raw_sss</strong> : instance of mne.io.Raw</p>
<blockquote class="last">
<div><p>The raw data with Maxwell filtering applied.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="mne.epochs.average_movements.html#mne.epochs.average_movements" title="mne.epochs.average_movements"><tt class="xref py py-obj docutils literal"><span class="pre">mne.epochs.average_movements</span></tt></a>, <a class="reference internal" href="mne.chpi.read_head_pos.html#mne.chpi.read_head_pos" title="mne.chpi.read_head_pos"><tt class="xref py py-obj docutils literal"><span class="pre">mne.chpi.read_head_pos</span></tt></a></p>
</div>
<p class="rubric">Notes</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.</span></p>
</div>
<p>Some of this code was adapted and relicensed (with BSD form) with
permission from Jussi Nurminen. These algorithms are based on work
from <a class="reference internal" href="#r24" id="id1">[R24]</a> and <a class="reference internal" href="#r25" id="id2">[R25]</a>.</p>
<p>Compared to Elekta&#8217;s MaxFilter™ software, our Maxwell filtering
algorithm currently provides the following features:</p>
<blockquote>
<div><ul class="simple">
<li>Bad channel reconstruction</li>
<li>Cross-talk cancellation</li>
<li>Fine calibration correction</li>
<li>tSSS</li>
<li>Coordinate frame translation</li>
<li>Regularization of internal components using information theory</li>
<li>Raw movement compensation
(using head positions estimated by MaxFilter)</li>
<li>cHPI subtraction (see <a class="reference internal" href="mne.chpi.filter_chpi.html#mne.chpi.filter_chpi" title="mne.chpi.filter_chpi"><tt class="xref py py-func docutils literal"><span class="pre">mne.chpi.filter_chpi()</span></tt></a>)</li>
</ul>
</div></blockquote>
<p>The following features are not yet implemented:</p>
<blockquote>
<div><ul class="simple">
<li><strong>Not certified for clinical use</strong></li>
<li>Automatic bad channel detection</li>
<li>Head position estimation</li>
</ul>
</div></blockquote>
<p>Our algorithm has the following enhancements:</p>
<blockquote>
<div><ul class="simple">
<li>Double floating point precision</li>
<li>Handling of 3D (in addition to 1D) fine calibration files</li>
<li>Automated processing of split (-1.fif) and concatenated files</li>
<li>Epoch-based movement compensation as described in <a class="reference internal" href="#r24" id="id3">[R24]</a> through
<a class="reference internal" href="mne.epochs.average_movements.html#mne.epochs.average_movements" title="mne.epochs.average_movements"><tt class="xref py py-func docutils literal"><span class="pre">mne.epochs.average_movements()</span></tt></a></li>
<li><strong>Experimental</strong> processing of data from (un-compensated)
non-Elekta systems</li>
</ul>
</div></blockquote>
<p>Use of Maxwell filtering routines with non-Elekta systems is currently
<strong>experimental</strong>. Worse results for non-Elekta systems are expected due
to (at least):</p>
<blockquote>
<div><ul class="simple">
<li>Missing fine-calibration and cross-talk cancellation data for
other systems.</li>
<li>Processing with reference sensors has not been vetted.</li>
<li>Regularization of components may not work well for all systems.</li>
<li>Coil integration has not been optimized using Abramowitz/Stegun
definitions.</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Various Maxwell filtering algorithm components are covered by
patents owned by Elekta Oy, Helsinki, Finland.
These patents include, but may not be limited to:</p>
<blockquote>
<div><ul class="simple">
<li>US2006031038 (Signal Space Separation)</li>
<li>US6876196 (Head position determination)</li>
<li>WO2005067789 (DC fields)</li>
<li>WO2005078467 (MaxShield)</li>
<li>WO2006114473 (Temporal Signal Space Separation)</li>
</ul>
</div></blockquote>
<p class="last">These patents likely preclude the use of Maxwell filtering code
in commercial applications. Consult a lawyer if necessary.</p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r24" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R24]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id3">2</a>, <a class="fn-backref" href="#id4">3</a>)</em> <p>Taulu S. and Kajola M. &#8220;Presentation of electromagnetic
multichannel data: The signal space separation method,&#8221;
Journal of Applied Physics, vol. 97, pp. 124905 1-10, 2005.</p>
<p class="last"><a class="reference external" href="http://lib.tkk.fi/Diss/2008/isbn9789512295654/article2.pdf">http://lib.tkk.fi/Diss/2008/isbn9789512295654/article2.pdf</a></p>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r25" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R25]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id5">2</a>)</em> <p>Taulu S. and Simola J. &#8220;Spatiotemporal signal space separation
method for rejecting nearby interference in MEG measurements,&#8221;
Physics in Medicine and Biology, vol. 51, pp. 1759-1768, 2006.</p>
<p class="last"><a class="reference external" href="http://lib.tkk.fi/Diss/2008/isbn9789512295654/article3.pdf">http://lib.tkk.fi/Diss/2008/isbn9789512295654/article3.pdf</a></p>
</td></tr>
</tbody>
</table>
</dd></dl>

<div style='clear:both'></div></div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2012-2016, MNE Developers. Last updated on 2016-05-11.<br/>
    </p>
  </div>
</footer>
  </body>
</html>